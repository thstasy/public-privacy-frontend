{"ast":null,"code":"import _createClass from \"/Users/stasy/Desktop/Public+Privacy_0831/public-privacy-frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"/Users/stasy/Desktop/Public+Privacy_0831/public-privacy-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _assertThisInitialized from \"/Users/stasy/Desktop/Public+Privacy_0831/public-privacy-frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/stasy/Desktop/Public+Privacy_0831/public-privacy-frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/stasy/Desktop/Public+Privacy_0831/public-privacy-frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport { EventDispatcher, Quaternion, Vector3 } from 'three';\nvar _changeEvent = {\n  type: 'change'\n};\nvar FlyControls = /*#__PURE__*/function (_EventDispatcher) {\n  _inherits(FlyControls, _EventDispatcher);\n  var _super = _createSuper(FlyControls);\n  function FlyControls(object, domElement) {\n    var _this;\n    _classCallCheck(this, FlyControls);\n    _this = _super.call(this);\n    _this.object = object;\n    _this.domElement = domElement;\n\n    // API\n\n    // Set to false to disable this control\n    _this.enabled = true;\n    _this.movementSpeed = 1.0;\n    _this.rollSpeed = 0.005;\n    _this.dragToLook = false;\n    _this.autoForward = false;\n\n    // disable default target object behavior\n\n    // internals\n\n    var scope = _assertThisInitialized(_this);\n    var EPS = 0.000001;\n    var lastQuaternion = new Quaternion();\n    var lastPosition = new Vector3();\n    _this.tmpQuaternion = new Quaternion();\n    _this.status = 0;\n    _this.moveState = {\n      up: 0,\n      down: 0,\n      left: 0,\n      right: 0,\n      forward: 0,\n      back: 0,\n      pitchUp: 0,\n      pitchDown: 0,\n      yawLeft: 0,\n      yawRight: 0,\n      rollLeft: 0,\n      rollRight: 0\n    };\n    _this.moveVector = new Vector3(0, 0, 0);\n    _this.rotationVector = new Vector3(0, 0, 0);\n    _this.keydown = function (event) {\n      if (event.altKey || this.enabled === false) {\n        return;\n      }\n      switch (event.code) {\n        case 'ShiftLeft':\n        case 'ShiftRight':\n          this.movementSpeedMultiplier = .1;\n          break;\n        case 'KeyW':\n          this.moveState.forward = 1;\n          break;\n        case 'KeyS':\n          this.moveState.back = 1;\n          break;\n        case 'KeyA':\n          this.moveState.left = 1;\n          break;\n        case 'KeyD':\n          this.moveState.right = 1;\n          break;\n        case 'KeyR':\n          this.moveState.up = 1;\n          break;\n        case 'KeyF':\n          this.moveState.down = 1;\n          break;\n        case 'ArrowUp':\n          this.moveState.pitchUp = 1;\n          break;\n        case 'ArrowDown':\n          this.moveState.pitchDown = 1;\n          break;\n        case 'ArrowLeft':\n          this.moveState.yawLeft = 1;\n          break;\n        case 'ArrowRight':\n          this.moveState.yawRight = 1;\n          break;\n        case 'KeyQ':\n          this.moveState.rollLeft = 1;\n          break;\n        case 'KeyE':\n          this.moveState.rollRight = 1;\n          break;\n      }\n      this.updateMovementVector();\n      this.updateRotationVector();\n    };\n    _this.keyup = function (event) {\n      if (this.enabled === false) return;\n      switch (event.code) {\n        case 'ShiftLeft':\n        case 'ShiftRight':\n          this.movementSpeedMultiplier = 1;\n          break;\n        case 'KeyW':\n          this.moveState.forward = 0;\n          break;\n        case 'KeyS':\n          this.moveState.back = 0;\n          break;\n        case 'KeyA':\n          this.moveState.left = 0;\n          break;\n        case 'KeyD':\n          this.moveState.right = 0;\n          break;\n        case 'KeyR':\n          this.moveState.up = 0;\n          break;\n        case 'KeyF':\n          this.moveState.down = 0;\n          break;\n        case 'ArrowUp':\n          this.moveState.pitchUp = 0;\n          break;\n        case 'ArrowDown':\n          this.moveState.pitchDown = 0;\n          break;\n        case 'ArrowLeft':\n          this.moveState.yawLeft = 0;\n          break;\n        case 'ArrowRight':\n          this.moveState.yawRight = 0;\n          break;\n        case 'KeyQ':\n          this.moveState.rollLeft = 0;\n          break;\n        case 'KeyE':\n          this.moveState.rollRight = 0;\n          break;\n      }\n      this.updateMovementVector();\n      this.updateRotationVector();\n    };\n    _this.pointerdown = function (event) {\n      if (this.enabled === false) return;\n      if (this.dragToLook) {\n        this.status++;\n      } else {\n        switch (event.button) {\n          case 0:\n            this.moveState.forward = 1;\n            break;\n          case 2:\n            this.moveState.back = 1;\n            break;\n        }\n        this.updateMovementVector();\n      }\n    };\n    _this.pointermove = function (event) {\n      if (this.enabled === false) return;\n      if (!this.dragToLook || this.status > 0) {\n        var container = this.getContainerDimensions();\n        var halfWidth = container.size[0] / 2;\n        var halfHeight = container.size[1] / 2;\n        this.moveState.yawLeft = -(event.pageX - container.offset[0] - halfWidth) / halfWidth;\n        this.moveState.pitchDown = (event.pageY - container.offset[1] - halfHeight) / halfHeight;\n        this.updateRotationVector();\n      }\n    };\n    _this.pointerup = function (event) {\n      if (this.enabled === false) return;\n      if (this.dragToLook) {\n        this.status--;\n        this.moveState.yawLeft = this.moveState.pitchDown = 0;\n      } else {\n        switch (event.button) {\n          case 0:\n            this.moveState.forward = 0;\n            break;\n          case 2:\n            this.moveState.back = 0;\n            break;\n        }\n        this.updateMovementVector();\n      }\n      this.updateRotationVector();\n    };\n    _this.contextMenu = function (event) {\n      if (this.enabled === false) return;\n      event.preventDefault();\n    };\n    _this.update = function (delta) {\n      if (this.enabled === false) return;\n      var moveMult = delta * scope.movementSpeed;\n      var rotMult = delta * scope.rollSpeed;\n      scope.object.translateX(scope.moveVector.x * moveMult);\n      scope.object.translateY(scope.moveVector.y * moveMult);\n      scope.object.translateZ(scope.moveVector.z * moveMult);\n      scope.tmpQuaternion.set(scope.rotationVector.x * rotMult, scope.rotationVector.y * rotMult, scope.rotationVector.z * rotMult, 1).normalize();\n      scope.object.quaternion.multiply(scope.tmpQuaternion);\n      if (lastPosition.distanceToSquared(scope.object.position) > EPS || 8 * (1 - lastQuaternion.dot(scope.object.quaternion)) > EPS) {\n        scope.dispatchEvent(_changeEvent);\n        lastQuaternion.copy(scope.object.quaternion);\n        lastPosition.copy(scope.object.position);\n      }\n    };\n    _this.updateMovementVector = function () {\n      var forward = this.moveState.forward || this.autoForward && !this.moveState.back ? 1 : 0;\n      this.moveVector.x = -this.moveState.left + this.moveState.right;\n      this.moveVector.y = -this.moveState.down + this.moveState.up;\n      this.moveVector.z = -forward + this.moveState.back;\n\n      //console.log( 'move:', [ this.moveVector.x, this.moveVector.y, this.moveVector.z ] );\n    };\n\n    _this.updateRotationVector = function () {\n      this.rotationVector.x = -this.moveState.pitchDown + this.moveState.pitchUp;\n      this.rotationVector.y = -this.moveState.yawRight + this.moveState.yawLeft;\n      this.rotationVector.z = -this.moveState.rollRight + this.moveState.rollLeft;\n\n      //console.log( 'rotate:', [ this.rotationVector.x, this.rotationVector.y, this.rotationVector.z ] );\n    };\n\n    _this.getContainerDimensions = function () {\n      if (this.domElement != document) {\n        return {\n          size: [this.domElement.offsetWidth, this.domElement.offsetHeight],\n          offset: [this.domElement.offsetLeft, this.domElement.offsetTop]\n        };\n      } else {\n        return {\n          size: [window.innerWidth, window.innerHeight],\n          offset: [0, 0]\n        };\n      }\n    };\n    _this.dispose = function () {\n      this.domElement.removeEventListener('contextmenu', _contextmenu);\n      this.domElement.removeEventListener('pointerdown', _pointerdown);\n      this.domElement.removeEventListener('pointermove', _pointermove);\n      this.domElement.removeEventListener('pointerup', _pointerup);\n      window.removeEventListener('keydown', _keydown);\n      window.removeEventListener('keyup', _keyup);\n    };\n    var _contextmenu = _this.contextMenu.bind(_assertThisInitialized(_this));\n    var _pointermove = _this.pointermove.bind(_assertThisInitialized(_this));\n    var _pointerdown = _this.pointerdown.bind(_assertThisInitialized(_this));\n    var _pointerup = _this.pointerup.bind(_assertThisInitialized(_this));\n    var _keydown = _this.keydown.bind(_assertThisInitialized(_this));\n    var _keyup = _this.keyup.bind(_assertThisInitialized(_this));\n    _this.domElement.addEventListener('contextmenu', _contextmenu);\n    _this.domElement.addEventListener('pointerdown', _pointerdown);\n    _this.domElement.addEventListener('pointermove', _pointermove);\n    _this.domElement.addEventListener('pointerup', _pointerup);\n    window.addEventListener('keydown', _keydown);\n    window.addEventListener('keyup', _keyup);\n    _this.updateMovementVector();\n    _this.updateRotationVector();\n    return _this;\n  }\n  return _createClass(FlyControls);\n}(EventDispatcher);\nexport { FlyControls };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}