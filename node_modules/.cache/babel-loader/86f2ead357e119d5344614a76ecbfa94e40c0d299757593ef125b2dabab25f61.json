{"ast":null,"code":"import _regeneratorRuntime from\"/Users/stasy/Desktop/Public+Privacy_0831/public-privacy-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/stasy/Desktop/Public+Privacy_0831/public-privacy-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/stasy/Desktop/Public+Privacy_0831/public-privacy-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useContext}from\"react\";import{useNavigate,useParams}from\"react-router-dom\";import httpClient from\"../http-common.js\";import Footer from\"../components/Footer.js\";import AuthContext from\"./shared/AuthContext.js\";import Alert from\"./Alert.js\";// Update the path to your Alert.js file\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var OpinionDetails=function OpinionDetails(){var _useContext=useContext(AuthContext),loginToken=_useContext.loginToken,username=_useContext.username;var _useParams=useParams(),id=_useParams.id;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),currentOpinion=_useState2[0],setCurrentOpinion=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),alert=_useState4[0],setAlert=_useState4[1];// Added alert state\nvar navigate=useNavigate();// Read\nvar getOpinion=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(id){var headers,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:headers={\"loginToken\":loginToken};_context.prev=1;_context.next=4;return httpClient.get(\"/forum/opinions/\".concat(id),{withCredentials:true,headers:headers});case 4:response=_context.sent;return _context.abrupt(\"return\",response);case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 11:case\"end\":return _context.stop();}},_callee,null,[[1,8]]);}));return function getOpinion(_x){return _ref.apply(this,arguments);};}();var removeOpinion=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(id){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:setAlert({type:\"decision\",message:\"Are you sure you want to delete this opinion?\",onConfirm:function(){var _onConfirm=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var headers,response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:headers={\"loginToken\":loginToken};_context2.prev=1;_context2.next=4;return httpClient.delete(\"/forum/opinions/\".concat(id),{withCredentials:true,headers:headers});case 4:response=_context2.sent;if((response===null||response===void 0?void 0:response.status)===204){setAlert({type:\"notification\",message:\"Deleted!\",onClose:function onClose(){return navigate(\"/forum/opinions\");}});}return _context2.abrupt(\"return\",response);case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);setAlert({type:\"notification\",message:\"Either 1. Only the initial author can modify the content, 2. An unknown loading bug. Come back later!\",onClose:function onClose(){return navigate(\"/forum/opinions\");}});return _context2.abrupt(\"return\");case 14:case\"end\":return _context2.stop();}},_callee2,null,[[1,9]]);}));function onConfirm(){return _onConfirm.apply(this,arguments);}return onConfirm;}(),onCancel:function onCancel(){}});case 1:case\"end\":return _context3.stop();}},_callee3);}));return function removeOpinion(_x2){return _ref2.apply(this,arguments);};}();var handleDelete=function handleDelete(){removeOpinion(id);};var handleEdit=function handleEdit(){navigate(\"/forum/opinions/edit/\".concat(id));};var stayOnPage=function stayOnPage(){navigate(\"/forum/opinions/\".concat(id));};useEffect(function(){stayOnPage();},[]);useEffect(function(){getOpinion(id).then(function(response){var message=response.status;var opinionData=response.data;var updatedAt=new Date(opinionData.updatedAt).toUTCString();var createdAt=new Date(opinionData.createdAt).toUTCString();setCurrentOpinion({id:opinionData.id,updatedAt:updatedAt,createdAt:createdAt,collaborator_name:username,category:opinionData.category,body:opinionData.body,title:opinionData.title,country:opinionData.country,city:opinionData.city});if(message===204){setAlert({type:\"notification\",message:\"Apologies. This opinion is deleted.\",onClose:function onClose(){return navigate(\"/collaborator/dashboard\");}});}else if(message===403){setAlert({type:\"notification\",message:\"Sorry, you are not authorized to see the content.\",onClose:function onClose(){return navigate(\"/about\");}});}else if(message===500){setAlert({type:\"notification\",message:\"Server-side issues. We'll try to fix it asap.\",onClose:function onClose(){return navigate(\"/about\");}});}}).catch(function(error){console.log(error);});},[id]);return/*#__PURE__*/_jsxs(_Fragment,{children:[alert&&/*#__PURE__*/_jsx(Alert,{type:alert.type,message:alert.message,onClose:alert.onClose,onConfirm:alert.onConfirm,onCancel:alert.onCancel}),/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-left\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-8\",children:currentOpinion&&/*#__PURE__*/_jsx(\"div\",{style:{width:\"100%\",paddingLeft:\"0\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{border:\"10px solid black\",padding:\"1em\",margin:\"1em 0\"},children:[/*#__PURE__*/_jsxs(\"article\",{children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-capitalize \",style:{wordBreak:\"break-word\",whiteSpace:\"pre-line\"},children:currentOpinion.title}),/*#__PURE__*/_jsx(\"div\",{className:\"my-3\",style:{marginBottom:\"0.5em\",fontWeight:\"bolder\"},children:/*#__PURE__*/_jsx(\"span\",{className:\"text-capitalize\",style:{wordBreak:\"break-word\"},children:currentOpinion.category})}),/*#__PURE__*/_jsx(\"div\",{className:\"my-3\",style:{marginBottom:\"0.5em\",wordBreak:\"break-word\",whiteSpace:\"pre-line\"},children:currentOpinion.body}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),currentOpinion.country||currentOpinion.city?/*#__PURE__*/_jsxs(\"div\",{className:\"my-3\",style:{marginBottom:\"0.1em\",wordBreak:\"break-word\",textAlign:\"right\",fontSize:\"smaller\"},children:[\"inspired at \",/*#__PURE__*/_jsxs(\"span\",{style:{fontWeight:\"bolder\"},children:[currentOpinion.country,\", \",currentOpinion.city]})]}):null,/*#__PURE__*/_jsx(\"div\",{className:\"my-3\",style:{marginBottom:\"0.5em\"},children:/*#__PURE__*/_jsxs(\"h6\",{style:{fontWeight:\"lighter\",fontSize:\"smaller\",textAlign:\"right\"},children:[\"Last Updated: \",new Date(currentOpinion.updatedAt).toLocaleDateString()]})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleEdit,style:{backgroundColor:\"black\",color:\"white\",borderRadius:\"3px\"},children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDelete,className:\"ms-3\",style:{backgroundColor:\"black\",color:\"white\",borderRadius:\"3px\"},children:\"Delete\"})]})})})})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Footer,{})]});};export default OpinionDetails;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}